import java.awt.*;
import  java.io.*;
import java.util.Scanner;

import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class lalalaa {
    public static void main(String[] args) throws IOException, InvalidFormatException {
        String filename = "C:\\Users\\ironm\\Desktop\\FORMULA MANIPAL\\excel.xlsx";
        XSSFWorkbook workbook = new XSSFWorkbook();
        XSSFSheet sheet = workbook.createSheet("excelsheet");

        File text = new File("C:\\Users\\ironm\\Desktop\\FORMULA MANIPAL\\rahul.txt");
        Scanner sc = new Scanner(text);
        Scanner in = new Scanner(System.in);

int x =0;

        String[][] array = new String[20][20];
        while (sc.hasNextLine()) {
            String a = sc.nextLine();
            int y =0,s=0;
            for(int k = 0; k<a.length();k++){

                if((int) a.charAt(k)==32){
                    String b = a.substring(s,k);
                    array[x][y]=b;
                    s=k+1;
                    y++;
                }
                if(k==(a.length()-1)){
                    String b = a.substring(s,k+1);
                    array[x][y]=b;
                    y++;
                }
              }
            x++;
        }


        int k, l;

        for (k = 0; k < 20; k++) {
            XSSFRow rowhead = sheet.createRow((short) k);
            for (l = 0; l < 20; l++) {
                rowhead.createCell(l).setCellValue(array[k][l]);
            }
        }
        FileOutputStream fileOut = new FileOutputStream(filename);
        workbook.write(fileOut);
        fileOut.close();
        workbook.close();
        System.out.println("The excel file has been created successfully.");

        Desktop.getDesktop().open(new File("C:\\Users\\ironm\\Desktop\\FORMULA MANIPAL\\excel.xlsx"));

// excel to css without caution to what data is in cell

        Workbook wb = new XSSFWorkbook(new File("C:\\Users\\ironm\\Desktop\\FORMULA MANIPAL\\excel.xlsx"));
        PrintStream out = new PrintStream(new FileOutputStream("C:\\Users\\ironm\\Desktop\\FORMULA MANIPAL\\csv.csv"),
                true, "UTF-8");
        byte[] bom = {(byte)0xEF, (byte)0xBB, (byte)0xBF};
        Sheet sheet1 = wb.getSheetAt(0);
        for (int r = 0, rn = sheet1.getLastRowNum() ; r <= rn ; r++) {
            Row row = sheet1.getRow(r);
            if ( row == null )
            { out.println(','); continue; }
            for (int c = 0, cn = row.getLastCellNum() ; c < cn ; c++) {
                Cell cell = row.getCell(c, Row.MissingCellPolicy.RETURN_BLANK_AS_NULL);
                if(c==cn-1 && cell!=null){
                    out.print(cell);
                }
                else if(cell!=null) out.print(cell+",");
    }
            out.println();
            Desktop.getDesktop().open(new File("C:\\Users\\ironm\\Desktop\\FORMULA MANIPAL\\csv.csv"));
    }}
}
